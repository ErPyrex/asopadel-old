{% extends 'base.html' %}
{% block title %}Detalle del Partido{% endblock %}
{% block content %}
    <div class="container mt-4">
        <div class="row justify-content-center">
            <div class="col-lg-9">
                <div class="card border-0 shadow-lg rounded-4 overflow-hidden"
                     style="background: #0f172a">
                    <!-- Header -->
                    <div class="card-header py-4 px-4 border-0"
                         style="background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)">
                        <h3 class="mb-0 text-white d-flex align-items-center">
                            <i class="ti ti-ball-tennis me-3 fs-3"></i>
                            Detalles del Partido
                        </h3>
                    </div>
                    <div class="card-body p-4 p-md-5">
                        <!-- Torneo -->
                        <div class="mb-4 p-3 rounded-3"
                             style="background: rgba(59, 130, 246, 0.1);
                                    border: 1px solid rgba(59, 130, 246, 0.3)">
                            <div class="d-flex align-items-center gap-3">
                                <i class="ti ti-trophy text-primary fs-3"></i>
                                <div>
                                    <div class="text-muted small text-uppercase fw-bold">Torneo / Evento</div>
                                    {% if partido.torneo %}
                                        <div class="text-white fw-bold fs-5">{{ partido.torneo.nombre }}</div>
                                        {% if partido.torneo.categoria %}
                                            <div class="text-muted small">Categoría: {{ partido.torneo.categoria.nombre }}</div>
                                        {% endif %}
                                    {% else %}
                                        <div class="text-white fw-bold fs-5">Amistoso / Casual</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- Información básica -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <div class="p-3 rounded-3"
                                     style="background: rgba(255,255,255,0.03);
                                            border: 1px solid rgba(255,255,255,0.08)">
                                    <div class="text-muted small text-uppercase fw-bold mb-1">
                                        <i class="ti ti-calendar me-1"></i> Fecha
                                    </div>
                                    <div class="text-white fw-bold">{{ partido.fecha|date:"d M, Y" }}</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3 rounded-3"
                                     style="background: rgba(255,255,255,0.03);
                                            border: 1px solid rgba(255,255,255,0.08)">
                                    <div class="text-muted small text-uppercase fw-bold mb-1">
                                        <i class="ti ti-clock me-1"></i> Hora
                                    </div>
                                    <div class="text-white fw-bold">{{ partido.hora|time:"H:i" }}</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3 rounded-3"
                                     style="background: rgba(255,255,255,0.03);
                                            border: 1px solid rgba(255,255,255,0.08)">
                                    <div class="text-muted small text-uppercase fw-bold mb-1">
                                        <i class="ti ti-map-pin me-1"></i> Cancha
                                    </div>
                                    {% if partido.cancha %}
                                        <div class="text-white fw-bold">{{ partido.cancha.nombre }}</div>
                                        <div class="text-muted small">{{ partido.cancha.ubicacion }}</div>
                                    {% else %}
                                        <div class="text-muted">No asignada</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- Jugadores -->
                        <div class="mb-4">
                            <div class="text-muted small text-uppercase fw-bold mb-3">
                                <i class="ti ti-users me-1"></i> Jugadores
                            </div>
                            <div class="row g-3">
                                <!-- Equipo 1 -->
                                <div class="col-md-6">
                                    <div class="p-3 rounded-3 h-100"
                                         style="background: rgba(59, 130, 246, 0.1);
                                                border: 1px solid rgba(59, 130, 246, 0.3)">
                                        <div class="small fw-bold text-primary text-uppercase mb-3">
                                            Equipo 1
                                            {% if partido.equipo_ganador == 1 %}<span class="badge bg-success ms-2">Ganador</span>{% endif %}
                                        </div>
                                        {% for jugador in partido.equipo1.all %}
                                            <div class="d-flex align-items-center gap-2 mb-2">
                                                <div class="rounded-circle bg-primary bg-opacity-25 d-flex align-items-center justify-content-center text-white fw-bold"
                                                     style="width: 40px;
                                                            height: 40px;
                                                            font-size: 0.85rem">
                                                    {{ jugador.first_name|first }}{{ jugador.last_name|first }}
                                                </div>
                                                <div>
                                                    <div class="text-white fw-medium">{{ jugador.get_full_name }}</div>
                                                    <div class="text-muted small">Ranking: {{ jugador.ranking|default:0 }}</div>
                                                </div>
                                            </div>
                                        {% empty %}
                                            <p class="text-muted small mb-0">Sin jugadores asignados</p>
                                        {% endfor %}
                                    </div>
                                </div>
                                <!-- Equipo 2 -->
                                <div class="col-md-6">
                                    <div class="p-3 rounded-3 h-100"
                                         style="background: rgba(239, 68, 68, 0.1);
                                                border: 1px solid rgba(239, 68, 68, 0.3)">
                                        <div class="small fw-bold text-danger text-uppercase mb-3">
                                            Equipo 2
                                            {% if partido.equipo_ganador == 2 %}<span class="badge bg-success ms-2">Ganador</span>{% endif %}
                                        </div>
                                        {% for jugador in partido.equipo2.all %}
                                            <div class="d-flex align-items-center gap-2 mb-2">
                                                <div class="rounded-circle bg-danger bg-opacity-25 d-flex align-items-center justify-content-center text-white fw-bold"
                                                     style="width: 40px;
                                                            height: 40px;
                                                            font-size: 0.85rem">
                                                    {{ jugador.first_name|first }}{{ jugador.last_name|first }}
                                                </div>
                                                <div>
                                                    <div class="text-white fw-medium">{{ jugador.get_full_name }}</div>
                                                    <div class="text-muted small">Ranking: {{ jugador.ranking|default:0 }}</div>
                                                </div>
                                            </div>
                                        {% empty %}
                                            <p class="text-muted small mb-0">Sin jugadores asignados</p>
                                        {% endfor %}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Árbitro -->
                        <div class="mb-4">
                            <div class="text-muted small text-uppercase fw-bold mb-2">
                                <i class="ti ti-gavel me-1"></i> Árbitro
                            </div>
                            <div class="p-3 rounded-3"
                                 style="background: rgba(255,255,255,0.03);
                                        border: 1px solid rgba(255,255,255,0.08)">
                                {% if partido.arbitro %}
                                    <div class="d-flex align-items-center gap-2">
                                        <div class="rounded-circle bg-warning bg-opacity-25 d-flex align-items-center justify-content-center text-white fw-bold"
                                             style="width: 40px;
                                                    height: 40px;
                                                    font-size: 0.85rem">
                                            {{ partido.arbitro.first_name|first }}{{ partido.arbitro.last_name|first }}
                                        </div>
                                        <div>
                                            <div class="text-white fw-medium">{{ partido.arbitro.get_full_name }}</div>
                                            <div class="text-muted small">{{ partido.arbitro.cedula }}</div>
                                        </div>
                                    </div>
                                {% else %}
                                    <span class="text-muted">No asignado</span>
                                {% endif %}
                            </div>
                        </div>
                        <!-- Estado y Marcador -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <div class="p-3 rounded-3"
                                     style="background: rgba(255,255,255,0.03);
                                            border: 1px solid rgba(255,255,255,0.08)">
                                    <div class="text-muted small text-uppercase fw-bold mb-2">Estado</div>
                                    <span class="badge fs-6 {% if partido.estado == 'pendiente' %}bg-warning text-dark {% elif partido.estado == 'confirmado' %}bg-info {% elif partido.estado == 'finalizado' %}bg-success {% elif partido.estado == 'cancelado' %}bg-danger {% endif %}">
                                        {{ partido.get_estado_display }}
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="p-3 rounded-3"
                                     style="background: rgba(255,255,255,0.03);
                                            border: 1px solid rgba(255,255,255,0.08)">
                                    <div class="text-muted small text-uppercase fw-bold mb-2">
                                        <i class="ti ti-chart-bar me-1"></i> Marcador
                                    </div>
                                    {% if partido.marcador %}
                                        <div class="text-white fw-bold fs-4">{{ partido.marcador }}</div>
                                    {% else %}
                                        <div class="text-muted">Sin marcador</div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- Botones de acción -->
                        <div class="d-flex gap-2 flex-wrap justify-content-end mt-4 pt-3"
                             style="border-top: 1px solid rgba(255,255,255,0.1)">
                            <a href="{% url 'core:admin_edit_match' partido.id %}"
                               class="btn btn-warning px-4 py-2">
                                <i class="ti ti-edit me-2"></i> Editar
                            </a>
                            <a href="{% url 'core:admin_partidos_list' %}"
                               class="btn btn-secondary px-4 py-2">
                                <i class="ti ti-arrow-left me-2"></i> Volver a Lista
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
